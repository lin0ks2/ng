/* ========================================================================== */
/*  TOKENS.CSS — ЧИСТАЯ СБОРКА (Идеально) + iOS-анимации и мелкие украшательства */
/*  Важно: браузерная ветка (Chrome/Safari) оставлена как была — эталон.       */
/*  PWA отделён и не дублирует safe-area снизу.                                */
/*  Добавлены универсальные токены анимаций и мягкие press‑эффекты.            */
/* ========================================================================== */

/* =========================
   БАЗОВЫЕ ПЕРЕМЕННЫЕ (CSS)
   ========================= */
:root{
  --brand:#1fb6ff;                 /* основной брендовый цвет (иконки/акценты) */
  --brand-dark:#0ea5e9;            /* более тёмный оттенок бренда */
  --burger:var(--brand);           /* цвет кнопки «три линии» по умолчанию */

  --header-pad-x:14px;             /* горизонтальные отступы шапки */
  --header-pad-bottom:8px;         /* нижний отступ внутри шапки */

  --safe-top:env(safe-area-inset-top,0px);      /* безопасная зона сверху (iOS вырез) */
  --safe-bottom:env(safe-area-inset-bottom,0px);/* безопасная зона снизу (iOS home-бар) */

  --title-size:26px;               /* размер названия в шапке */
  --logo-size:44px;                /* размер логотипа в шапке */
  --gap-tight:8px;                 /* компактный межэлементный зазор */

  --footer-h:60px;                 /* базовая высота футера без safe-area */
  --footer-sep:#e5e7eb;            /* цвет разделительных линий */
  --footer-bg:#fff;                /* фон футера */
  --footer-fg:#333;                /* цвет иконок/текста футера */
  --nav-gap:12px;                  /* зазоры между кнопками в футере */
  --nav-icon-size:28px;            /* базовый размер иконок футера */

  --header-h-actual:64px;          /* фактическая высота шапки (перезаписывает JS) */
  --footer-h-actual:calc(var(--footer-h) + var(--safe-bottom)); /* фактическая высота футера (перезапишет JS) */

  /* Токены анимации iOS-стиля */
  --anim-fast:160ms;
  --anim-normal:220ms;
  --ease-ios:cubic-bezier(.22,.61,.36,1);
}

/* чуть больше размеры на более широких экранах */
@media (min-width:480px){
  :root{ --title-size:28px; --logo-size:48px; --nav-icon-size:30px; }
}

/* =========================
   СБРОСЫ/ОСНОВЫ
   ========================= */
html,body{ margin:0; padding:0; }
*{ -webkit-tap-highlight-color:transparent; }
body{
  font-family:system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;
  background:#fff; color:#111;
}
body.menu-open{ overflow:hidden; touch-action:none; }

/* =========================
   ШАПКА (HEADER)
   ========================= */
.header{
  position:sticky; top:0; z-index:1000;
  display:flex; align-items:center; justify-content:space-between;
  padding:0 var(--header-pad-x);
  padding-top:max(var(--safe-top),8px);
  padding-bottom:var(--header-pad-bottom);
  background:#fff; border-bottom:1px solid #dfe3e8;
}
.brand{ display:flex; align-items:center; }
.brand-link{ display:flex; align-items:center; gap:var(--gap-tight); color:inherit; text-decoration:none; }
.brand img{ width:var(--logo-size); height:var(--logo-size); }
.brand-title{
  font-family:'Montserrat',system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;
  font-weight:700; font-size:var(--title-size); line-height:1.05; margin:0;
}

/* Кнопка «три линии» */
.burger{
  font-size:32px; line-height:1; color:var(--burger);
  background:none; border:0; cursor:pointer;
  -webkit-appearance:none; appearance:none; outline:none;
  transition:transform 120ms var(--ease-ios), color var(--anim-fast) ease;
}
body.menu-open .burger{ color:var(--footer-fg); transform:scale(1.06); }
.burger:active{ transform:scale(1.08); }

/* =========================
   КОНТЕНТ
   ========================= */
.content{
  padding:16px;
  padding-bottom:calc(var(--footer-h) + var(--safe-bottom) + 12px);
}

/* =========================
   ФУТЕР (НАВИГАЦИЯ)
   ========================= */
.app-footer{
  position:fixed; left:0; right:0; bottom:0;
  height:calc(var(--footer-h) + var(--safe-bottom));
  display:grid; grid-template-columns:repeat(5,minmax(0,1fr));
  column-gap:var(--nav-gap); padding-left:var(--nav-gap); padding-right:var(--nav-gap);
  background:var(--footer-bg); color:var(--footer-fg);
  border-top:1px solid var(--footer-sep);
  border-bottom:1px solid var(--footer-sep);
  z-index:1000; padding-bottom:var(--safe-bottom);
  box-shadow:none;
}
.app-footer .nav-btn{
  display:flex; align-items:center; justify-content:center;
  margin:0; padding:8px 4px 10px;
  background:transparent; border:0; color:inherit; font:inherit;
  cursor:pointer; width:100%;
  -webkit-appearance:none; appearance:none; outline:none;
}
.nav-icon{
  width:var(--nav-icon-size); height:var(--nav-icon-size);
  display:block; background-repeat:no-repeat; background-position:center; background-size:contain;
  pointer-events:none; user-select:none; -webkit-user-select:none;
  transition:transform 120ms var(--ease-ios), opacity .15s ease;
}

/* =========================
   ИКОНКИ (картинки из /img)
   ========================= */
/* обычные (неактивные) */
.nav-btn [data-icon="home"]   { background-image:url("../img/home_dark.svg"); }
.nav-btn [data-icon="book"]   { background-image:url("../img/book_dark.svg"); }
.nav-btn [data-icon="star"]   { background-image:url("../img/star_dark.svg"); }
.nav-btn [data-icon="warning"]{ background-image:url("../img/warning_dark.svg"); }
.nav-btn [data-icon="stats"]  { background-image:url("../img/stats_dark.svg"); }
/* hover-состояние */
@media (hover:hover){
  .nav-btn:hover [data-icon="home"]   { background-image:url("../img/home_hover.svg"); }
  .nav-btn:hover [data-icon="book"]   { background-image:url("../img/book_hover.svg"); }
  .nav-btn:hover [data-icon="star"]   { background-image:url("../img/star_hover.svg"); }
  .nav-btn:hover [data-icon="warning"]{ background-image:url("../img/warning_hover.svg"); }
  .nav-btn:hover [data-icon="stats"]  { background-image:url("../img/stats_hover.svg"); }
  .nav-btn:hover .nav-icon{ transform:translateY(-1px); }
}
/* активная вкладка */
.nav-btn.active .nav-icon{ transform:scale(1.06); }
.nav-btn.active [data-icon="home"]   { background-image:url("../img/home.svg"); }
.nav-btn.active [data-icon="book"]   { background-image:url("../img/book.svg"); }
.nav-btn.active [data-icon="star"]   { background-image:url("../img/star.svg"); }
.nav-btn.active [data-icon="warning"]{ background-image:url("../img/warning.svg"); }
.nav-btn.active [data-icon="stats"]  { background-image:url("../img/stats.svg"); }
.nav-btn:active .nav-icon{ transform:scale(1.08); }

/* =========================
   OFF-CANVAS (гамбургер)
   ========================= */
.oc-root{ position:fixed; inset:0; z-index:1100; pointer-events:none; }
.oc-overlay,.oc-panel{ pointer-events:auto; }

.oc-overlay{
  position:fixed; left:0; right:0;
  top:var(--header-h-actual);
  bottom:calc(var(--footer-h-actual) + 0px);
  background:rgba(0,0,0,.18);
  opacity:0; transition:opacity var(--anim-normal) var(--ease-ios);
}
body.menu-open .oc-overlay{ opacity:1; }

.oc-panel{
  position:fixed; right:0;
  top:var(--header-h-actual);
  bottom:calc(var(--footer-h-actual) + 0px);
  width:50vw; max-width:520px; min-width:280px;
  background:#fff; border:0; box-shadow:none;
  transform:translateX(100%); transition:transform var(--anim-normal) var(--ease-ios);
  display:flex; flex-direction:column;
}
body.menu-open .oc-panel{ transform:translateX(0); }

.oc-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 12px; border-bottom:1px solid #e5e7eb;
}
.oc-title{ font-weight:700; text-align:center; flex:1; }
.oc-back,.oc-close{
  background:transparent; border:0; font-size:20px; cursor:pointer; color:#333;
  -webkit-appearance:none; appearance:none; outline:none;
}
.oc-back{ margin-right:8px; } .oc-close{ margin-left:8px; }
.oc-body{ overflow:auto; padding:12px; -webkit-overflow-scrolling:touch; }

/* =========================
   ВЕТКИ ОКРУЖЕНИЙ
   ========================= */
/* 1) МОБИЛЬНЫЕ БРАУЗЕРЫ (Chrome/Safari) — идеальная ветка */
@media all and (display-mode:browser){
  .app-footer{ bottom:0px; }
}
/* 2) PWA (standalone) — прижимаем кнопки к самому низу, без дублей safe-area */
@media all and (display-mode:standalone){
  .app-footer{
    bottom:0;
    height:var(--footer-h);
    padding-bottom:0;
    border-bottom:0;
  }
}

/* =========================
   ДОП. НАСТРОЙКИ ДЛЯ iOS (SAFE-AREAS)
   ========================= */
@supports (-webkit-touch-callout:none){
  @media all and (display-mode:browser){
    .header{ padding-top:max(var(--safe-top),8px); }
    .app-footer{
      height:calc(var(--footer-h) + var(--safe-bottom));
      padding-bottom:var(--safe-bottom);
    }
  }
}

/* =========================
   БУРГЕР → ТОГЛЫ (Тема, Язык, Сложность)
   ========================= */
.menu-item.theme-toggle,
.menu-item.lang-toggle,
.menu-item.level-toggle{
  padding:14px 12px; display:flex; flex-direction:column; gap:8px;
}
.menu-label{ font-weight:600; font-size:15px; color:#333; }
.theme-switch,.lang-switch,.level-switch{
  display:flex; align-items:center; justify-content:center; gap:10px;
}
.theme-label,.lang-label,.level-label{ font-size:20px; line-height:1; }
.theme-label.light,.lang-label.left,.level-label.left{ margin-right:4px; font-size:14px; }
.theme-label.dark,.lang-label.right,.level-label.right{ margin-left:4px; font-size:14px; }
.switch{ position:relative; display:inline-block; width:48px; height:28px; }
.switch input{ opacity:0; width:0; height:0; }
.slider{
  position:absolute; inset:0; cursor:pointer;
  background-color:#ccc; border-radius:34px; transition:background-color .25s;
}
.slider:before{
  content:""; position:absolute; height:22px; width:22px; left:3px; bottom:3px;
  background:#fff; border-radius:50%; transition:transform .25s;
}
input:checked + .slider{ background-color:var(--burger); }
input:checked + .slider:before{ transform:translateX(20px); }

/* =========================
   БУРГЕР → ДЕЙСТВИЯ (нижний 5‑кнопочный ряд)
   ========================= */
.actions-row-bottom{
  display:grid; grid-template-columns:repeat(5,1fr);
  align-items:stretch; justify-items:stretch;
  border-top:1px solid #e5e7eb; background:#fff;
}
.actions-row-bottom .action-btn{
  position:relative; display:grid; place-items:center;
  min-height:56px; background:transparent; border:0; width:100%;
  cursor:pointer; -webkit-appearance:none; appearance:none; outline:none;
  font-size:22px;
}
.actions-row-bottom .action-btn:not(:last-child){ border-right:1px solid #eef1f4; }

/* =========================
   ОРИЕНТАЦИЯ: ЗАГЛУШКА ДЛЯ LANDSCAPE
   ========================= */
.orientation-guard{
  position:fixed; inset:0; z-index:1500;
  display:none; align-items:center; justify-content:center;
  padding:calc(16px + var(--safe-top)) 16px calc(16px + var(--safe-bottom));
  background:#fff; text-align:center; color:#111;
  font-family:system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;
}
.orientation-guard .og-inner{
  max-width:520px; border:1px solid #eef1f4; border-radius:14px; background:#fff;
  padding:16px 14px; box-shadow:none;
}
.orientation-guard .og-emoji{ font-size:28px; line-height:1; margin-bottom:8px; }
.orientation-guard .og-title{ font-weight:700; font-size:18px; margin:0 0 6px; }
.orientation-guard .og-text{ margin:0; font-size:14px; color:#374151; line-height:1.5; }

@media (orientation:landscape){
  .orientation-guard{ display:flex; }
  body.landscape-block{ overflow:hidden; touch-action:none; }
}

/* =========================
   iOS‑микродвижение (универсально)
   ========================= */
/* Мягкий «пресс» */
.mm-press{
  transform:translateZ(0); will-change:transform;
  transition:transform 120ms var(--ease-ios), filter 200ms ease;
}
.mm-press:active{ transform:scale(.98); }
@media (hover:hover){
  .mm-press:hover{ filter:brightness(1.03); }
}

/* Появление листов (legal/donate/др.) */
.mm-sheet{
  opacity:0; transform:translateY(8px);
  will-change:opacity, transform;
  transition:
    opacity var(--anim-normal) var(--ease-ios),
    transform var(--anim-normal) var(--ease-ios);
}
.mm-sheet.is-open{ opacity:1; transform:none; }

@media (prefers-reduced-motion: reduce){
  .mm-press, .mm-sheet{ transition:none !important; }
  .mm-press:active{ transform:none !important; }
}
