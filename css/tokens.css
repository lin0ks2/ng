/* tokens.css — объединённые правки, ничего не теряем
   - Оверлей и панель кликабельны; корень меню — нет (header/footer кликаются)
   - Блокируем скролл под меню
   - Убраны тени и бордеры панели; «двойная линия» исправлена
   - PWA: футер прижат к нижнему краю, учитывает safe-area
*/

:root{
  --brand:#1fb6ff; --brand-dark:#0ea5e9; --burger:var(--brand);
  --header-pad-x:14px; --header-pad-bottom:8px;
  --safe-top:env(safe-area-inset-top,0px); --safe-bottom:env(safe-area-inset-bottom,0px);
  --title-size:26px; --logo-size:44px; --gap-tight:8px;
  --footer-h:60px; --footer-sep:#e5e7eb; --footer-bg:#fff; --footer-fg:#333;
  --nav-gap:12px; --nav-icon-size:28px;
  --header-h-actual:64px; --footer-h-actual:calc(var(--footer-h) + var(--safe-bottom));
}
@media (min-width:480px){ :root{ --title-size:28px; --logo-size:48px; --nav-icon-size:30px; } }

html,body{margin:0;padding:0}
*{-webkit-tap-highlight-color:transparent}
body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;background:#fff;color:#111}
body.menu-open{overflow:hidden; touch-action:none;}

/* header */
.header{
  position:sticky; top:0; z-index:1000;
  display:flex; align-items:center; justify-content:space-between;
  padding:0 var(--header-pad-x);
  padding-top:max(var(--safe-top),8px);
  padding-bottom:var(--header-pad-bottom);
  background:#fff; border-bottom:1px solid #dfe3e8;
}
.brand{display:flex;align-items:center}
.brand-link{display:flex;align-items:center;gap:var(--gap-tight);color:inherit;text-decoration:none}
.brand img{width:var(--logo-size);height:var(--logo-size)}
.brand-title{font-family:'Montserrat',system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;font-weight:700;font-size:var(--title-size);line-height:1.05;margin:0}
.burger{
  font-size:32px; line-height:1; color:var(--burger);
  background:none; border:0; cursor:pointer;
  -webkit-appearance:none; appearance:none; outline:none;
  transition:transform .1s ease,color .12s ease;
}
body.menu-open .burger{ color:var(--footer-fg); transform:scale(1.06) }
.burger:active{ transform:scale(1.08) }

/* content */
.content{ padding:16px; padding-bottom:calc(var(--footer-h) + var(--safe-bottom) + 12px) }

/* footer */
.app-footer{
  position:fixed; left:0; right:0; bottom:0;
  height:calc(var(--footer-h) + var(--safe-bottom));
  display:grid; grid-template-columns:repeat(5,minmax(0,1fr));
  column-gap:var(--nav-gap); padding-left:var(--nav-gap); padding-right:var(--nav-gap);
  background:var(--footer-bg); color:var(--footer-fg);
  border-top:1px solid var(--footer-sep); border-bottom:1px solid var(--footer-sep);
  z-index:1000; padding-bottom:var(--safe-bottom);
  box-shadow:none;
}
.app-footer .nav-btn{
  display:flex; align-items:center; justify-content:center;
  margin:0; padding:8px 4px 10px;
  background:transparent; border:0; color:inherit; font:inherit;
  cursor:pointer; width:100%;
  -webkit-appearance:none; appearance:none; outline:none;
}
.nav-icon{
  width:var(--nav-icon-size); height:var(--nav-icon-size);
  display:block; background-repeat:no-repeat; background-position:center; background-size:contain;
  pointer-events:none; user-select:none; -webkit-user-select:none;
  transition:transform .12s ease, opacity .15s ease;
}

/* icons mapping (css/ → ../img) */
.nav-btn [data-icon="home"]   { background-image:url("../img/home_dark.svg") }
.nav-btn [data-icon="book"]   { background-image:url("../img/book_dark.svg") }
.nav-btn [data-icon="star"]   { background-image:url("../img/star_dark.svg") }
.nav-btn [data-icon="warning"]{ background-image:url("../img/warning_dark.svg") }
.nav-btn [data-icon="stats"]  { background-image:url("../img/stats_dark.svg") }
@media (hover:hover){
  .nav-btn:hover [data-icon="home"]   { background-image:url("../img/home_hover.svg") }
  .nav-btn:hover [data-icon="book"]   { background-image:url("../img/book_hover.svg") }
  .nav-btn:hover [data-icon="star"]   { background-image:url("../img/star_hover.svg") }
  .nav-btn:hover [data-icon="warning"]{ background-image:url("../img/warning_hover.svg") }
  .nav-btn:hover [data-icon="stats"]  { background-image:url("../img/stats_hover.svg") }
  .nav-btn:hover .nav-icon{ transform:translateY(-1px) }
}
.nav-btn.active .nav-icon{ transform:scale(1.06) }
.nav-btn.active [data-icon="home"]   { background-image:url("../img/home.svg") }
.nav-btn.active [data-icon="book"]   { background-image:url("../img/book.svg") }
.nav-btn.active [data-icon="star"]   { background-image:url("../img/star.svg") }
.nav-btn.active [data-icon="warning"]{ background-image:url("../img/warning.svg") }
.nav-btn.active [data-icon="stats"]  { background-image:url("../img/stats.svg") }
.nav-btn:active .nav-icon{ transform:scale(1.08) }

/* offcanvas — клики только на overlay/panel, header/footer кликаются; панель в «рельсах» */
.oc-root{ position:fixed; inset:0; z-index:1100; pointer-events:none; } /* ← не перехватывает клики глобально */
.oc-overlay,.oc-panel{ pointer-events:auto; }

.oc-overlay{
  position:fixed; left:0; right:0;
  top:var(--header-h-actual);
  bottom:calc(var(--footer-h-actual) + 0px); /* fix double line: подняли нижний край оверлея на 1px выше футера */
  background:rgba(0,0,0,.18);
  opacity:0; transition:opacity .18s ease;
}
body.menu-open .oc-overlay{ opacity:1 }

.oc-panel{
  position:fixed; right:0;
  top:var(--header-h-actual);
  bottom:calc(var(--footer-h-actual) + 0px); /* fix double line: подняли нижний край панели на 1px выше футера */
  width:50vw; max-width:520px; min-width:280px;
  background:#fff; border:0; box-shadow:none;
  transform:translateX(100%); transition:transform .22s ease;
  display:flex; flex-direction:column;
}
body.menu-open .oc-panel{ transform:translateX(0) }

.oc-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 12px; border-bottom:1px solid #e5e7eb;
}
.oc-title{ font-weight:700; text-align:center; flex:1; }
.oc-back,.oc-close{
  background:transparent; border:0; font-size:20px; cursor:pointer; color:#333;
  -webkit-appearance:none; appearance:none; outline:none;
}
.oc-back{ margin-right:8px } .oc-close{ margin-left:8px }

.oc-body{ overflow:auto; padding:12px; -webkit-overflow-scrolling:touch; }

/* browsers: если был лёгкий сдвиг — оставляем как в базе */
@media all and (display-mode:browser){
  .app-footer{ bottom:-4px; }
}

/* PWA: прижать футер к самому низу, учесть safe-area, убрать нижний бордер */
@media all and (display-mode:standalone){
  .app-footer{ bottom:0; padding-bottom:var(--safe-bottom); border-bottom:0; }
}

/* Safari */
@supports (-webkit-touch-callout:none){
  .header{ padding-top:max(var(--safe-top),8px) }
  .app-footer{ height:calc(var(--footer-h) + var(--safe-bottom)); padding-bottom:var(--safe-bottom) }
}
